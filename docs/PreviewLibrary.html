<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta name="author" content="Virx">
    <meta name="description" content="Preview the CalcPlus open-source library">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://virxec.github.io/CalcPlus/assets/logo.png">
    <script type="text/javascript" src="https://virxec.github.io/CalcPlus/assets/Library.js"></script>
    <script type="text/javascript" src="https://virxec.github.io/CalcPlus/assets/CPquery/1.15.js"></script>
    <title>Preview the CalcPlus Library</title>
    <style>
      body {
        color: black;
        background-color: white;
      }
      a {
        color: dark_blue;
      }
      .removeInput {
          color: grey;
          background: rgb(255, 110, 110);
          border: none;
      }
      .removeInput:hover {
          color:black;
          background: red;
          border: none;
      }
    </style>
  </head>
  <body>
    <noscript>Library couldn't be loaded! Please allow JavaScript to run on this page, or else most things won't work. Thank you!<br></noscript>
    <span id="console"></span>
    <a href="https://virxec.github.io/CalcPlus">Home</a>
    <form>
      <input type="radio" id="add" name="math-type" label="Addition Algorithm" checked="checked"> Addition
      <br>
      <input type="radio" id="sub" name="math-type" label="Subtraction Algorithm"> Subtraction
      <br>
      <input type="radio" id="multi" name="math-type" label="Multiplication Algorithm"> Multiplication
      <br>
      <input type="radio" id="expo" name="math-type" label="Exponents Algorithm (No decimals)"> Exponents (No decimals)
      <br>
      <input type="radio" id="div" name="math-type" label="Division Algorithm - In development"> Division (In development)
      <br>
      <input type="radio" id="isLessThan" name="math-type" label="Is Less Than Algorithm"> Is Less Than
      <br>
      <input type="radio" id="isGreaterThan" name="math-type" label="Is Greater Than Algorithm"> Is Greater Than
      <br>
      <input type="radio" id="isLessThanEqual" name="math-type" label="Is Less Than or Equal to Algorithm"> Is Less Than or Equal to
      <br>
      <input type="radio" id="isGreaterThanEqual" name="math-type" label="Is Greater Than or Equal to Algorithm"> Is Greater Than or Equal to
      <br>
      <input type="radio" id="round" name="math-type" label="Round Algorithm"> Round
      <br>
      <input type="radio" id="roundUp" name="math-type" label="Round up Algorithm"> Round Up
      <br>
      <input type="radio" id="roundDown" name="math-type" label="Round down Algorithm"> Round Down
    </form>
    <br>
    <button id="addInput">Add another input field</button>
    <br>
    Number: <input type="text" id="input1" label="Number input field #1">
    <br>
    Number: <input type="text" id="input2" label="Number input field #2">
    <br>
    <span id="extraInputs"></span>
    <button id="calc">Calculate...</button>
    <br>
    <br>
    <p id="output">Press "Calculate..."</p>
    
    <script>
      "use strict";
      try {
        var inputBoxes = 2;
        var divChecked = false;
        
        var getChecked = function(name) {
          return $("#name").checked();
        };
        $("#div").click(function() {
          divChecked = true;
          $("#extraInputs").html.append('<span id="divMax">Max decimal place: <input type="text" id="maxDecimal" label="Max number of decimals for division algorithm"/> <button class="removeInput" id="divMax" onclick="this.parentNode.remove();divChecked=false;document.getElementById("div").checked=false;document.getElementById("add").checked=true;" label="Delete max decimal field for division algorithm">X</button><br></span>');
        });
        
        var runCalc = function() {
          var final = {
            num: 0,
            display: false
          };
          if (getChecked("add")) {
            final.num = add($("#input1").val()), $("#input2").val());
            if (inputBoxes > 2) {
              for (var i=3; i<=inputBoxes; i++) {
                final.num = add(final.num, $("#input"+i.toString()).val());
              }
            }
            final.display = true;
          } else if (getChecked("sub")) {
            final.num = sub(document.getElementById("input1").value, document.getElementById("input2").value);
            if (inputBoxes > 2) {
              for (var s=3; s<=inputBoxes; s++) {
                final.num = sub(final.num, document.getElementById("input"+s.toString()).value);
              }
            }
            final.display = true;
          } else if (getChecked("multi")) {
            final.num = multi(document.getElementById("input1").value, document.getElementById("input2").value);
            if (inputBoxes > 2) {
              for (var m=3; m<=inputBoxes; m++) {
                final.num = multi(final.num, document.getElementById("input"+m.toString()).value);
              }
            }
            final.display = true;
          } else if (getChecked("expo")) {
            final.num = expo(document.getElementById("input1").value, document.getElementById("input2").value);
            if (inputBoxes > 2) {
              for (var e=3; e<=inputBoxes; e++) {
                final.num = expo(final.num, document.getElementById("input"+e.toString()).value);
              }
            }
            final.display = true;
          } else if (getChecked("div")) {
            var maxDecimals = document.getElementById("maxDecimals").value;
            final.num = div(document.getElementById("input1").value, document.getElementById("input2").value, maxDecimals);
            if (inputBoxes > 2) {
              for (var e=3; e<=inputBoxes; e++) {
                final.num = div(final.num, document.getElementById("input"+e.toString()).value, maxDecimals);
              }
            }
            final.display = true;
          } else if (getChecked("isLessThan")) {
            final.num = isLessThan(document.getElementById("input1").value, document.getElementById("input2").value);
            if (inputBoxes > 2) {
              for (var e=3; e<=inputBoxes; e++) {
                final.num = isLessThan(final.num, document.getElementById("input"+e.toString()).value);
              }
            }
            final.display = true;
          } else if (getChecked("isGreaterThan")) {
            final.num = isGreaterThan(document.getElementById("input1").value, document.getElementById("input2").value);
            if (inputBoxes > 2) {
              for (var e=3; e<=inputBoxes; e++) {
                final.num = isGreaterThan(final.num, document.getElementById("input"+e.toString()).value);
              }
            }
            final.display = true;
          } else if (getChecked("isLessThanEqual")) {
            final.num = isLessThanEqual(document.getElementById("input1").value, document.getElementById("input2").value);
            if (inputBoxes > 2) {
              for (var e=3; e<=inputBoxes; e++) {
                final.num = isLessThanEqual(final.num, document.getElementById("input"+e.toString()).value);
              }
            }
            final.display = true;
          } else if (getChecked("isGreaterThanEqual")) {
            final.num = isGreaterThanEqual(document.getElementById("input1").value, document.getElementById("input2").value);
            if (inputBoxes > 2) {
              for (var e=3; e<=inputBoxes; e++) {
                final.num = isGreaterThanEqual(final.num, document.getElementById("input"+e.toString()).value);
              }
            }
            final.display = true;
          } else if (getChecked("round")) {
            final.num = round(document.getElementById("input1").value, document.getElementById("input2").value);
            if (inputBoxes > 2) {
              for (var e=3; e<=inputBoxes; e++) {
                final.num = round(final.num, document.getElementById("input"+e.toString()).value);
              }
            }
            final.display = true;
          } else if (getChecked("roundUp")) {
            final.num = roundUp(document.getElementById("input1").value, document.getElementById("input2").value);
            if (inputBoxes > 2) {
              for (var e=3; e<=inputBoxes; e++) {
                final.num = roundUp(final.num, document.getElementById("input"+e.toString()).value);
              }
            }
            final.display = true;
          } else if (getChecked("roundDown")) {
            final.num = roundDown(document.getElementById("input1").value, document.getElementById("input2").value);
            if (inputBoxes > 2) {
              for (var e=3; e<=inputBoxes; e++) {
                final.num = roundDown(final.num, document.getElementById("input"+e.toString()).value);
              }
            }
            final.display = true;
          } else {
            console.error("ran nothing");
          }
          if (final.display) {
            $("#output").text.replace("Answer: "+final.num);
          }
        };
        $("#addInput").click(function(){
          inputBoxes++;
          $("#extraInputs").html.append('<span id="id'+inputBoxes+'">Number: <input type="text" id="input'+inputBoxes+'" label="Number input field #'+inputBoxes+'"/> <button class="removeInput" id="'+inputBoxes+'" onclick="this.parentNode.remove();inputBoxes-=1;" label="Delete input field #'+inputBoxes+'">X</button><br></span>');
        });
        $("#calc").click(function(){
          runCalc();
        });
      } catch(err) {
        console.error(err);
      }
    </script>
    
    <script>
      var c = $("#console").select();
      console.log = (...args) => args.forEach(m => c.appendChild(document.createTextNode(`\n ${m}`)));
      console.info = (...args) => args.forEach(e => {
        const s = $("span").create();
        s.textContent = "\n" + e;
        s.style.color = "blue";
        s.style.position = "fixed";
        c.appendChild(s);
      });
      console.warn = (...args) => args.forEach(e => {
        const s = $("span").create();
        s.textContent = "\n" + e;
        s.style.color = "yellow";
        s.style.position = "fixed";
        c.appendChild(s);
      });
      console.error = (...args) => args.forEach(e => {
        const s = $("span").create();
        s.textContent = "\n" + e;
        s.style.color = "red";
        s.style.position = "fixed";
        c.appendChild(s);
      });
        
      window.onerror = (e, s, l, c) => {
        console.error(`Error: ${e} at: ${s}  : ${l} : ${c}`);
      };
      
      if ($("isDark").local() == "Off" || $("isDark").local() == "On") {
        if ($("isDark").local() == "On") {
          $(0).css.replace('body { color: white; background-color: black; }');
          $(0).css.append('a { color: light_blue; }');
        }
      } else {
        $("isDark").local("Off");
      }
      
      self.addEventListener('install', function(event) {
        event.waitUntil(
          caches.open('calcplus-github-v1').then(function(cache) {
            return cache.addAll([
              "/assets/CPquery/1.15.js",
              "/assets/logo.png"
            ]);
          }));
      });
      self.addEventListener('install', function(event) {
        console.log('Installed PreviewLibrary.html', event);
      });
      self.addEventListener('activate', function(event) {
        console.log('Activated PreviewLibrary.html', event);
      });
      self.addEventListener('fetch', function(e) {
       e.respondWith(caches.match(e.request).then(function(response) {
        if(response) {
          return response;
        }
        return fetch(e.request);
       }));
      });
    </script>
  </body>
</html>
